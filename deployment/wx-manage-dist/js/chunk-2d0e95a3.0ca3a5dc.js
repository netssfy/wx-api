(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e95a3"],{"8cbd":function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("el-dialog",{attrs:{title:e.dataForm.id?"修改":"新增","close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(a){e.visible=a}}},[t("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"80px"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.dataFormSubmit()}}},[t("el-form-item",{attrs:{label:"媒体文件"}},[t("el-button",{attrs:{type:"primary"}},[e._v(" 选择文件 "),t("input",{staticStyle:{opacity:"0",height:"100%",position:"absolute",left:"0",top:"0"},attrs:{type:"file"},on:{change:e.onFileChange}})]),t("div",[e._v(e._s(e.dataForm.file.name))])],1),t("el-form-item",{attrs:{label:"媒体类型",prop:"mediaType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"媒体类型"},model:{value:e.dataForm.mediaType,callback:function(a){e.$set(e.dataForm,"mediaType",a)},expression:"dataForm.mediaType"}},[t("el-option",{attrs:{label:"图片（2M以内，支持PNG\\JPEG\\JPG\\GIF）",value:"image"}}),t("el-option",{attrs:{label:"视频（10M以内，只支持MP4）",value:"video"}}),t("el-option",{attrs:{label:"语音（2M、60s以内，支持AMR\\MP3）",value:"voice"}}),t("el-option",{attrs:{label:"缩略图（64K以内JPG）",value:"thumb"}})],1)],1),t("el-form-item",{attrs:{label:"素材名称",prop:"fileName"}},[t("el-input",{attrs:{placeholder:"为便于管理建议按用途分类+素材内容命名"},model:{value:e.dataForm.fileName,callback:function(a){e.$set(e.dataForm,"fileName",a)},expression:"dataForm.fileName"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(a){e.visible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",disabled:e.uploading},on:{click:function(a){return e.dataFormSubmit()}}},[e._v(e._s(e.uploading?"提交中...":"提交"))])],1)],1)},l=[],o=(t("b0c0"),{data:function(){return{visible:!1,uploading:!1,dataForm:{mediaId:"",file:"",fileName:"",mediaType:"image"},dataRule:{fileName:[{required:!0,message:"素材名称不能为空",trigger:"blur"}],mediaType:[{required:!0,message:"素材类型不能为空",trigger:"blur"}]}}},methods:{init:function(e){e&&(this.dataForm.mediaType=e),this.visible=!0},dataFormSubmit:function(){var e=this;this.uploading||this.$refs["dataForm"].validate((function(a){if(a){e.uploading=!0,console.log(e.dataForm);var t=new FormData;t.append("mediaId",e.dataForm.mediaId||""),t.append("file",e.dataForm.file),t.append("fileName",e.dataForm.fileName),t.append("mediaType",e.dataForm.mediaType),e.$http({url:e.$http.adornUrl("/manage/wxAssets/materialFileUpload"),method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}}).then((function(a){var t=a.data;t&&200===t.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.visible=!1,e.$emit("refreshDataList")}}):e.$message.error(t.msg),e.uploading=!1}))}}))},onFileChange:function(e){var a=event.currentTarget.files[0];this.dataForm.file=a,this.dataForm.fileName=a.name.substring(0,a.name.lastIndexOf("."));var t=a.type.substring(0,a.type.lastIndexOf("/"));"audio"==t&&(t="voice"),this.dataForm.mediaType=t}}}),r=o,n=t("2877"),s=Object(n["a"])(r,i,l,!1,null,null,null);a["default"]=s.exports}}]);