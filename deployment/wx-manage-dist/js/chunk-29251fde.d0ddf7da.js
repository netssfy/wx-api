(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29251fde"],{"1c59":function(t,e,n){"use strict";var i=n("6d61"),a=n("6566");i("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),a)},"26f6":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mod-config"},[n("el-form",{attrs:{inline:!0,model:t.dataForm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getDataList()}}},[n("el-form-item",[n("el-select",{attrs:{placeholder:"时间"},model:{value:t.dataForm.startTime,callback:function(e){t.$set(t.dataForm,"startTime",e)},expression:"dataForm.startTime"}},t._l(t.timeSelections,(function(t,e){return n("el-option",{key:e,attrs:{value:t,label:e}})})),1)],1),n("el-form-item",[n("el-select",{attrs:{placeholder:"消息类型"},model:{value:t.dataForm.msgTypes,callback:function(e){t.$set(t.dataForm,"msgTypes",e)},expression:"dataForm.msgTypes"}},[n("el-option",{attrs:{value:"",label:"不限类型"}}),n("el-option",{attrs:{value:"text,image,voice,shortvideo,video,news,music,location,link",label:"消息"}}),n("el-option",{attrs:{value:"event,transfer_customer_service",label:"事件"}})],1)],1),n("el-form-item",[n("el-button",{on:{click:function(e){return t.getDataList()}}},[t._v("查询")])],1)],1),t._m(0),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}]},t._l(t.dataList,(function(e,i){return n("div",{key:i,staticClass:"msg-item"},[n("div",{staticClass:"avatar"},[n("el-avatar",{attrs:{shape:"square",size:60,src:t.getUserInfo(e.openid).headimgurl}})],1),n("div",{staticClass:"item-content"},[n("div",{staticClass:"flex justify-between margin-bottom"},[n("div",{staticClass:"text-cut"},[t._v(t._s(t.getUserInfo(e.openid).nickname||"--"))]),n("div",[t._v(t._s(t.$moment(e.createTime).calendar()))]),n("div",{staticClass:"reply-btn"},[t.canReply(e.createTime)?n("div",{staticClass:"el-icon-s-promotion",on:{click:function(n){return t.replyHandle(e.openid)}}},[t._v("回复")]):t._e()])]),n("wx-msg-preview",{attrs:{msg:e,singleLine:""}})],1)])})),0),n("el-pagination",{attrs:{"current-page":t.pageIndex,"page-sizes":[10,20,50,100],"page-size":t.pageSize,total:t.totalCount,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.sizeChangeHandle,"current-change":t.currentChangeHandle}}),n("wx-msg-reply",{ref:"wxMsgReply",on:{success:t.onReplyed}})],1)},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text-gray"},[t._v(" 24小时内消息可回复。此后台展示消息有一分钟左右延迟，如需畅聊请使用 "),n("a",{attrs:{href:"https://mpkf.weixin.qq.com/",target:"_blank"}},[t._v("公众平台客服")])])}],r=(n("d3b7"),n("3ca3"),n("ddb0"),n("4de4"),n("d81d"),n("a630"),n("6062"),n("99af"),n("7db0"),"YYYY/MM/DD hh:mm:ss"),s={data:function(){return{timeSelections:{"近24小时":this.$moment().subtract(1,"days").format(r),"近3天":this.$moment().subtract(3,"days").format(r),"近7天":this.$moment().subtract(7,"days").format(r),"近30天":this.$moment().subtract(30,"days").format(r)},dataForm:{startTime:this.$moment().subtract(1,"days").format(r),msgTypes:""},dataList:[],userDataList:[],pageIndex:1,pageSize:20,totalCount:0,dataListLoading:!1,dataListSelections:[]}},components:{WxMsgReply:function(){return n.e("chunk-0072525b").then(n.bind(null,"6ce2"))},WxMsgPreview:function(){return n.e("chunk-8debcff0").then(n.bind(null,"6073"))}},activated:function(){this.getDataList()},methods:{getDataList:function(){var t=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/manage/wxMsg/list"),method:"get",params:this.$http.adornParams({page:this.pageIndex,limit:this.pageSize,msgTypes:this.dataForm.msgTypes,startTime:this.dataForm.startTime,sidx:"create_time",order:"desc"})}).then((function(e){var n=e.data;n&&200===n.code?(t.dataList=n.page.list,t.totalCount=n.page.totalCount,t.refreshUserList(t.dataList)):(t.dataList=[],t.totalCount=0),t.dataListLoading=!1}))},refreshUserList:function(t){var e=this,n=t.map((function(t){return t.openid})).filter((function(t){return!e.userDataList.some((function(e){return e.openid==t}))}));n.length&&(n=Array.from(new Set(n)),this.$http({url:this.$http.adornUrl("/manage/wxUser/listByIds"),method:"post",data:this.$http.adornParams(n,!1)}).then((function(t){var n=t.data;n&&200===n.code&&(e.userDataList=e.userDataList.concat(n.data))})))},getUserInfo:function(t){return this.userDataList.find((function(e){return e.openid==t}))||{nickname:"--",headimgurl:""}},canReply:function(t){return new Date(t).getTime()>(new Date).getTime()-864e5},sizeChangeHandle:function(t){this.pageSize=t,this.pageIndex=1,this.getDataList()},currentChangeHandle:function(t){this.pageIndex=t,this.getDataList()},selectionChangeHandle:function(t){this.dataListSelections=t},replyHandle:function(t){var e=this;this.$nextTick((function(){e.$refs.wxMsgReply.init(t)}))},onReplyed:function(t){this.dataList.unshift({openid:t.openid,msgType:t.replyType,detail:{content:t.replyContent},inOut:1,createTime:new Date})}}},o=s,u=(n("de17"),n("2877")),c=Object(u["a"])(o,i,a,!1,null,"f1dd88d2",null);e["default"]=c.exports},"4df4":function(t,e,n){"use strict";var i=n("da84"),a=n("0366"),r=n("c65b"),s=n("7b0b"),o=n("9bdd"),u=n("e95a"),c=n("68ee"),d=n("07fa"),f=n("8418"),l=n("9a1f"),v=n("35a1"),p=i.Array;t.exports=function(t){var e=s(t),n=c(this),i=arguments.length,h=i>1?arguments[1]:void 0,m=void 0!==h;m&&(h=a(h,i>2?arguments[2]:void 0));var g,y,b,x,w,k,L=v(e),C=0;if(!L||this==p&&u(L))for(g=d(e),y=n?new this(g):p(g);g>C;C++)k=m?h(e[C],C):e[C],f(y,C,k);else for(x=l(e,L),w=x.next,y=n?new this:[];!(b=r(w,x)).done;C++)k=m?o(x,h,[b.value,C],!0):b.value,f(y,C,k);return y.length=C,y}},"4fad":function(t,e,n){var i=n("d039"),a=n("861d"),r=n("c6b6"),s=n("d86b"),o=Object.isExtensible,u=i((function(){o(1)}));t.exports=u||s?function(t){return!!a(t)&&((!s||"ArrayBuffer"!=r(t))&&(!o||o(t)))}:o},6062:function(t,e,n){n("1c59")},"64b6":function(t,e,n){},6566:function(t,e,n){"use strict";var i=n("9bf2").f,a=n("7c73"),r=n("e2cc"),s=n("0366"),o=n("19aa"),u=n("2266"),c=n("7dd0"),d=n("2626"),f=n("83ab"),l=n("f183").fastKey,v=n("69f3"),p=v.set,h=v.getterFor;t.exports={getConstructor:function(t,e,n,c){var d=t((function(t,i){o(t,v),p(t,{type:e,index:a(null),first:void 0,last:void 0,size:0}),f||(t.size=0),void 0!=i&&u(i,t[c],{that:t,AS_ENTRIES:n})})),v=d.prototype,m=h(e),g=function(t,e,n){var i,a,r=m(t),s=y(t,e);return s?s.value=n:(r.last=s={index:a=l(e,!0),key:e,value:n,previous:i=r.last,next:void 0,removed:!1},r.first||(r.first=s),i&&(i.next=s),f?r.size++:t.size++,"F"!==a&&(r.index[a]=s)),t},y=function(t,e){var n,i=m(t),a=l(e);if("F"!==a)return i.index[a];for(n=i.first;n;n=n.next)if(n.key==e)return n};return r(v,{clear:function(){var t=this,e=m(t),n=e.index,i=e.first;while(i)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete n[i.index],i=i.next;e.first=e.last=void 0,f?e.size=0:t.size=0},delete:function(t){var e=this,n=m(e),i=y(e,t);if(i){var a=i.next,r=i.previous;delete n.index[i.index],i.removed=!0,r&&(r.next=a),a&&(a.previous=r),n.first==i&&(n.first=a),n.last==i&&(n.last=r),f?n.size--:e.size--}return!!i},forEach:function(t){var e,n=m(this),i=s(t,arguments.length>1?arguments[1]:void 0);while(e=e?e.next:n.first){i(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!y(this,t)}}),r(v,n?{get:function(t){var e=y(this,t);return e&&e.value},set:function(t,e){return g(this,0===t?0:t,e)}}:{add:function(t){return g(this,t=0===t?0:t,t)}}),f&&i(v,"size",{get:function(){return m(this).size}}),d},setStrong:function(t,e,n){var i=e+" Iterator",a=h(e),r=h(i);c(t,e,(function(t,e){p(this,{type:i,target:t,state:a(t),kind:e,last:void 0})}),(function(){var t=r(this),e=t.kind,n=t.last;while(n&&n.removed)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),d(e)}}},"6d61":function(t,e,n){"use strict";var i=n("23e7"),a=n("da84"),r=n("e330"),s=n("94ca"),o=n("6eeb"),u=n("f183"),c=n("2266"),d=n("19aa"),f=n("1626"),l=n("861d"),v=n("d039"),p=n("1c7e"),h=n("d44e"),m=n("7156");t.exports=function(t,e,n){var g=-1!==t.indexOf("Map"),y=-1!==t.indexOf("Weak"),b=g?"set":"add",x=a[t],w=x&&x.prototype,k=x,L={},C=function(t){var e=r(w[t]);o(w,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(y&&!l(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return y&&!l(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(y&&!l(t))&&e(this,0===t?0:t)}:function(t,n){return e(this,0===t?0:t,n),this})},_=s(t,!f(x)||!(y||w.forEach&&!v((function(){(new x).entries().next()}))));if(_)k=n.getConstructor(e,t,g,b),u.enable();else if(s(t,!0)){var z=new k,T=z[b](y?{}:-0,1)!=z,D=v((function(){z.has(1)})),$=p((function(t){new x(t)})),S=!y&&v((function(){var t=new x,e=5;while(e--)t[b](e,e);return!t.has(-0)}));$||(k=e((function(t,e){d(t,w);var n=m(new x,t,k);return void 0!=e&&c(e,n[b],{that:n,AS_ENTRIES:g}),n})),k.prototype=w,w.constructor=k),(D||S)&&(C("delete"),C("has"),g&&C("get")),(S||T)&&C(b),y&&w.clear&&delete w.clear}return L[t]=k,i({global:!0,forced:k!=x},L),h(k,t),y||n.setStrong(k,t,g),k}},7156:function(t,e,n){var i=n("1626"),a=n("861d"),r=n("d2bb");t.exports=function(t,e,n){var s,o;return r&&i(s=e.constructor)&&s!==n&&a(o=s.prototype)&&o!==n.prototype&&r(t,o),t}},"7db0":function(t,e,n){"use strict";var i=n("23e7"),a=n("b727").find,r=n("44d2"),s="find",o=!0;s in[]&&Array(1)[s]((function(){o=!1})),i({target:"Array",proto:!0,forced:o},{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),r(s)},"9bdd":function(t,e,n){var i=n("825a"),a=n("2a62");t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(s){a(t,"throw",s)}}},a630:function(t,e,n){var i=n("23e7"),a=n("4df4"),r=n("1c7e"),s=!r((function(t){Array.from(t)}));i({target:"Array",stat:!0,forced:s},{from:a})},bb2f:function(t,e,n){var i=n("d039");t.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},d81d:function(t,e,n){"use strict";var i=n("23e7"),a=n("b727").map,r=n("1dde"),s=r("map");i({target:"Array",proto:!0,forced:!s},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},d86b:function(t,e,n){var i=n("d039");t.exports=i((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},de17:function(t,e,n){"use strict";n("64b6")},f183:function(t,e,n){var i=n("23e7"),a=n("e330"),r=n("d012"),s=n("861d"),o=n("1a2d"),u=n("9bf2").f,c=n("241c"),d=n("057f"),f=n("4fad"),l=n("90e3"),v=n("bb2f"),p=!1,h=l("meta"),m=0,g=function(t){u(t,h,{value:{objectID:"O"+m++,weakData:{}}})},y=function(t,e){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,h)){if(!f(t))return"F";if(!e)return"E";g(t)}return t[h].objectID},b=function(t,e){if(!o(t,h)){if(!f(t))return!0;if(!e)return!1;g(t)}return t[h].weakData},x=function(t){return v&&p&&f(t)&&!o(t,h)&&g(t),t},w=function(){k.enable=function(){},p=!0;var t=c.f,e=a([].splice),n={};n[h]=1,t(n).length&&(c.f=function(n){for(var i=t(n),a=0,r=i.length;a<r;a++)if(i[a]===h){e(i,a,1);break}return i},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d.f}))},k=t.exports={enable:w,fastKey:y,getWeakData:b,onFreeze:x};r[h]=!0}}]);