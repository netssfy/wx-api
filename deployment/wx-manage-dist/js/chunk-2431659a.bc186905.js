(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2431659a"],{7102:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{attrs:{id:"app-menu"}},[n("div",{staticClass:"weixin-preview"},[n("div",{staticClass:"weixin-bd"},[n("div",{staticClass:"weixin-header"},[e._v("公众号菜单")]),n("ul",{staticClass:"weixin-menu",attrs:{id:"weixin-menu"}},[e._l(e.menu.buttons,(function(t,s){return n("li",{key:s,staticClass:"menu-item",class:{current:e.selectedMenuIndex===s&&1==e.selectedMenuLevel},on:{click:function(t){return e.selectMenu(s)}}},[n("div",{staticClass:"menu-item-title"},[n("span",[e._v(e._s(t.name))])]),n("ul",{staticClass:"weixin-sub-menu"},[e._l(t.subButtons,(function(t,u){return n("li",{key:u,staticClass:"menu-sub-item",class:{current:e.selectedMenuIndex===s&&e.selectedSubMenuIndex===u&&2==e.selectedMenuLevel,"on-drag-over":e.onDragOverMenu==s+"_"+u},attrs:{draggable:"true"},on:{click:function(t){return t.stopPropagation(),e.selectSubMenu(s,u)},dragstart:function(t){return e.selectSubMenu(s,u)},dragover:function(t){t.preventDefault(),e.onDragOverMenu=s+"_"+u},drop:function(t){return e.onDrop(s,u)}}},[n("div",{staticClass:"menu-item-title"},[n("span",[e._v(e._s(t.name))])])])})),t.subButtons.length<5?n("li",{staticClass:"menu-sub-item",class:{"on-drag-over":e.onDragOverMenu==s+"_"+t.subButtons.length},on:{click:function(t){return t.stopPropagation(),e.addMenu(2,s)},dragover:function(n){n.preventDefault(),e.onDragOverMenu=s+"_"+t.subButtons.length},drop:function(n){return e.onDrop(s,t.subButtons.length)}}},[e._m(0,!0)]):e._e(),n("i",{staticClass:"menu-arrow arrow_out"}),n("i",{staticClass:"menu-arrow arrow_in"})],2)])})),e.menu.buttons.length<3?n("li",{staticClass:"menu-item",on:{click:function(t){return e.addMenu(1)}}},[n("i",{staticClass:"el-icon-plus"})]):e._e()],2)])]),e.selectedMenuLevel>0?n("div",{staticClass:"weixin-menu-detail"},[n("wx-menu-button-editor",{attrs:{button:e.selectedButton,selectedMenuLevel:e.selectedMenuLevel},on:{delMenu:e.delMenu}})],1):e._e()]),e.isAuth("wx:menu:save")?n("div",{staticClass:"weixin-btn-group",on:{click:e.updateWxMenu}},[n("el-button",{attrs:{type:"success",icon:"el-icon-upload"}},[e._v("发布")]),n("el-button",{attrs:{type:"warning",icon:"el-icon-delete"},on:{click:e.delMenu}},[e._v("清空")])],1):e._e()])},u=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"menu-item-title"},[n("i",{staticClass:"el-icon-plus"})])}],i=(n("d3b7"),n("3ca3"),n("ddb0"),n("a434"),{components:{wxMenuButtonEditor:function(){return n.e("chunk-4f390334").then(n.bind(null,"1ccb"))}},data:function(){return{menu:{buttons:[]},selectedMenuIndex:"",selectedSubMenuIndex:"",selectedMenuLevel:0,selectedButton:"",onDragOverMenu:""}},mounted:function(){this.getWxMenu()},methods:{getWxMenu:function(){var e=this;this.$http({url:this.$http.adornUrl("/manage/wxMenu/getMenu")}).then((function(t){var n=t.data;200==n.code?e.menu=n.data.menu:e.$message({type:"error",message:n.msg})}))},selectMenu:function(e){this.selectedMenuLevel=1,this.selectedSubMenuIndex="",this.selectedMenuIndex=e,this.selectedButton=this.menu.buttons[e]},selectSubMenu:function(e,t){this.selectedMenuLevel=2,this.selectedMenuIndex=e,this.selectedSubMenuIndex=t,this.selectedButton=this.menu.buttons[e].subButtons[t]},addMenu:function(e,t){1==e&&this.menu.buttons.length<3&&(this.menu.buttons.push({type:"view",name:"菜单名称",subButtons:[],url:""}),this.selectMenu(this.menu.buttons.length-1)),2==e&&this.menu.buttons[t].subButtons.length<5&&(this.menu.buttons[t].subButtons.push({type:"view",name:"子菜单名称",url:""}),this.selectSubMenu(t,this.menu.buttons[t].subButtons.length-1))},delMenu:function(){1==this.selectedMenuLevel&&confirm("删除后菜单下设置的内容将被删除")?(this.menu.buttons.splice(this.selectedMenuIndex,1),this.unSelectMenu()):2==this.selectedMenuLevel&&(this.menu.buttons[this.selectedMenuIndex].subButtons.splice(this.selectedSubMenuIndex,1),this.unSelectMenu())},unSelectMenu:function(){this.selectedMenuLevel=0,this.selectedMenuIndex="",this.selectedSubMenuIndex="",this.selectedButton=""},updateWxMenu:function(){var e=this;this.$http({url:this.$http.adornUrl("/manage/wxMenu/updateMenu"),data:this.menu,method:"post"}).then((function(t){var n=t.data;200==n.code?e.$message.success("操作成功"):e.$message.error(n.msg)}))},onDrop:function(e,t){if(this.onDragOverMenu="",e!=this.selectedMenuIndex||t!=this.selectedSubMenuIndex)if(e!=this.selectedMenuIndex&&this.menu.buttons[e].subButtons.length>=5)this.$message.error("目标组已满");else{this.menu.buttons[e].subButtons.splice(t,0,this.selectedButton);var n=this.selectedSubMenuIndex;e==this.selectedMenuIndex&&t<this.selectedSubMenuIndex&&n++,this.menu.buttons[this.selectedMenuIndex].subButtons.splice(n,1),this.unSelectMenu()}}}}),l=i,c=(n("c927"),n("2877")),o=Object(c["a"])(l,s,u,!1,null,null,null);t["default"]=o.exports},a434:function(e,t,n){"use strict";var s=n("23e7"),u=n("da84"),i=n("23cb"),l=n("5926"),c=n("07fa"),o=n("7b0b"),a=n("65f0"),r=n("8418"),d=n("1dde"),h=d("splice"),M=u.TypeError,m=Math.max,b=Math.min,v=9007199254740991,f="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!h},{splice:function(e,t){var n,s,u,d,h,p,g=o(this),x=c(g),w=i(e,x),_=arguments.length;if(0===_?n=s=0:1===_?(n=0,s=x-w):(n=_-2,s=b(m(l(t),0),x-w)),x+n-s>v)throw M(f);for(u=a(g,s),d=0;d<s;d++)h=w+d,h in g&&r(u,d,g[h]);if(u.length=s,n<s){for(d=w;d<x-s;d++)h=d+s,p=d+n,h in g?g[p]=g[h]:delete g[p];for(d=x;d>x-s+n;d--)delete g[d-1]}else if(n>s)for(d=x-s;d>w;d--)h=d+s-1,p=d+n-1,h in g?g[p]=g[h]:delete g[p];for(d=0;d<n;d++)g[d+w]=arguments[d+2];return g.length=x-s+n,u}})},c927:function(e,t,n){"use strict";n("d565")},d565:function(e,t,n){}}]);