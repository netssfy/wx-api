(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1410aea0","chunk-35a9a1a8"],{"30dd":function(e,t,a){},"408a":function(e,t,a){var s=a("e330");e.exports=s(1..valueOf)},4149:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"panel"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.addOrUpdateVisible,expression:"!addOrUpdateVisible"}]},[a("el-form",{attrs:{inline:!0,model:e.dataForm}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.selectMode,expression:"!selectMode"}]},[e.isAuth("wx:wxassets:save")?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.addOrUpdateHandle()}}},[e._v("新增")]):e._e()],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading,expression:"dataListLoading"}],staticClass:"flex justify-start"},e._l(e.rows,(function(t){return a("div",{key:t},[e._l(e.dataList,(function(s,i){return[i%e.rows==t-1?a("div",{key:s.mediaId,staticClass:"card",on:{click:function(t){return e.onSelect(s)}}},[a("div",{staticClass:"card-preview"},e._l(s.content.articles,(function(t,s){return a("a",{key:s,staticClass:"article-item",attrs:{href:t.url,target:"_blank"}},[a("div",{staticClass:"article-title"},[e._v(e._s(t.title))]),a("el-image",{staticClass:"article-thumb",attrs:{src:t.thumbUrl}})],1)})),0),a("div",{staticClass:"card-footer"},[a("div",[e._v(e._s(e.$moment(s.updateTime).calendar()))]),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.selectMode,expression:"!selectMode"}],staticClass:"flex justify-between align-center"},[a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:s.mediaId,expression:"item.mediaId",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onCopyError,expression:"onCopyError",arg:"error"}],attrs:{size:"mini",type:"text",icon:"el-icon-copy-document"}},[e._v("复制media_id")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(t){return e.addOrUpdateHandle(s)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(t){return e.deleteHandle(s.mediaId)}}},[e._v("删除")])],1)])]):e._e()]}))],2)})),0),a("el-pagination",{attrs:{"current-page":e.pageIndex,"page-size":e.pageSize,total:e.totalCount,layout:"total, prev,pager, next, jumper"},on:{"current-change":e.currentChangeHandle}})],1),a("add-or-update",{ref:"addOrUpdate",attrs:{visible:e.addOrUpdateVisible},on:{refreshDataList:e.onChange,hide:function(t){e.addOrUpdateVisible=!1}}})],1)},i=[],n=(a("a9e3"),a("c1e1")),r={name:"material-news",components:{AddOrUpdate:n["default"]},props:{selectMode:{type:Boolean,default:!1},rows:{type:Number,default:4}},data:function(){return{dataForm:{},addOrUpdateVisible:!1,dataList:[],pageIndex:1,pageSize:20,totalCount:0,dataListLoading:!1}},mounted:function(){this.init()},methods:{init:function(){this.dataList.length||this.getDataList()},getDataList:function(){var e=this;this.dataListLoading||(this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/manage/wxAssets/materialNewsBatchGet"),params:this.$http.adornParams({page:this.pageIndex})}).then((function(t){var a=t.data;200==a.code?(e.dataList=a.data.items,e.totalCount=a.data.totalCount):e.$message.error(a.msg),e.dataListLoading=!1})))},onSelect:function(e){this.selectMode&&this.$emit("selected",e)},deleteHandle:function(e){var t=this;this.$confirm("确定对[mediaId=".concat(e,"]进行删除操作?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$http({url:t.$http.adornUrl("/manage/wxAssets/materialDelete"),method:"post",data:{mediaId:e}}).then((function(e){var a=e.data;a&&200===a.code?t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){return t.onChange()}}):t.$message.error(a.msg)}))}))},currentChangeHandle:function(e){this.pageIndex=e,this.getDataList()},addOrUpdateHandle:function(e){var t=this;this.addOrUpdateVisible=!0,this.$nextTick((function(){t.$refs.addOrUpdate.init(e||"")}))},onCopySuccess:function(){this.$message.success("已复制")},onCopyError:function(e){this.$message.error("复制失败,可能是此浏览器不支持复制")},onChange:function(){this.pageIndex=1,this.getDataList(),this.$emit("change")}}},l=r,o=(a("ab9f"),a("2877")),c=Object(o["a"])(l,s,i,!1,null,"fbe97f84",null);t["default"]=c.exports},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var s=a("e330"),i=a("1d80"),n=a("577e"),r=a("5899"),l=s("".replace),o="["+r+"]",c=RegExp("^"+o+o+"*"),d=RegExp(o+o+"*$"),u=function(e){return function(t){var a=n(i(t));return 1&e&&(a=l(a,c,"")),2&e&&(a=l(a,d,"")),a}};e.exports={start:u(1),end:u(2),trim:u(3)}},7156:function(e,t,a){var s=a("1626"),i=a("861d"),n=a("d2bb");e.exports=function(e,t,a){var r,l;return n&&s(r=t.constructor)&&r!==a&&i(l=r.prototype)&&l!==a.prototype&&n(e,l),e}},7472:function(e,t,a){},a9e3:function(e,t,a){"use strict";var s=a("83ab"),i=a("da84"),n=a("e330"),r=a("94ca"),l=a("6eeb"),o=a("1a2d"),c=a("7156"),d=a("3a9b"),u=a("d9b5"),m=a("c04e"),p=a("d039"),h=a("241c").f,f=a("06cf").f,v=a("9bf2").f,g=a("408a"),b=a("58a8").trim,x="Number",I=i[x],C=I.prototype,w=i.TypeError,y=n("".slice),$=n("".charCodeAt),_=function(e){var t=m(e,"number");return"bigint"==typeof t?t:N(t)},N=function(e){var t,a,s,i,n,r,l,o,c=m(e,"number");if(u(c))throw w("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=b(c),t=$(c,0),43===t||45===t){if(a=$(c,2),88===a||120===a)return NaN}else if(48===t){switch($(c,1)){case 66:case 98:s=2,i=49;break;case 79:case 111:s=8,i=55;break;default:return+c}for(n=y(c,2),r=n.length,l=0;l<r;l++)if(o=$(n,l),o<48||o>i)return NaN;return parseInt(n,s)}return+c};if(r(x,!I(" 0o1")||!I("0b1")||I("+0x1"))){for(var k,U=function(e){var t=arguments.length<1?0:I(_(e)),a=this;return d(C,a)&&p((function(){g(a)}))?c(Object(t),a,U):t},S=s?h(I):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),L=0;S.length>L;L++)o(I,k=S[L])&&!o(U,k)&&v(U,k,f(I,k));U.prototype=C,C.constructor=U,l(i,x,U)}},ab9f:function(e,t,a){"use strict";a("7472")},c1e1:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}]},[a("div",{staticClass:"flex"},[a("div",{staticClass:"card-list"},[a("div",{staticClass:"text-center margin-bottom"},[e._v("图文列表")]),e._l(e.articles,(function(t,s){return a("div",{key:s,staticClass:"card-item",class:{selected:e.selectedIndex==s},on:{click:function(t){e.selectedIndex=s}}},[a("div",{staticClass:"text-cut-name"},[e._v(e._s(t.title))])])})),a("div",{directives:[{name:"show",rawName:"v-show",value:e.articles.length<8&&!e.mediaId,expression:"articles.length<8 && !mediaId"}],staticClass:"card-add el-icon-plus",on:{click:function(t){return e.addArticle()}}})],2),e.articles.length?a("el-form",{ref:"dataForm",attrs:{size:"mini",model:e.articles[e.selectedIndex],rules:e.dataRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"标题"},model:{value:e.articles[e.selectedIndex].title,callback:function(t){e.$set(e.articles[e.selectedIndex],"title",t)},expression:"articles[selectedIndex].title"}})],1),a("el-form-item",{attrs:{label:"封面图",prop:"thumbMediaId"}},[a("el-input",{attrs:{placeholder:"封面图media_id"},model:{value:e.articles[e.selectedIndex].thumbMediaId,callback:function(t){e.$set(e.articles[e.selectedIndex],"thumbMediaId",t)},expression:"articles[selectedIndex].thumbMediaId"}},[a("div",{attrs:{slot:"append"},on:{click:function(t){e.assetsSelectorVisible=!0}},slot:"append"},[e._v("从素材库中选择")])])],1),a("el-form-item",{attrs:{label:"摘要",prop:"digest"}},[a("el-input",{attrs:{placeholder:"摘要"},model:{value:e.articles[e.selectedIndex].digest,callback:function(t){e.$set(e.articles[e.selectedIndex],"digest",t)},expression:"articles[selectedIndex].digest"}})],1),a("el-form-item",{attrs:{label:"原文地址",prop:"contentSourceUrl"}},[a("el-input",{attrs:{placeholder:"阅读原文链接"},model:{value:e.articles[e.selectedIndex].contentSourceUrl,callback:function(t){e.$set(e.articles[e.selectedIndex],"contentSourceUrl",t)},expression:"articles[selectedIndex].contentSourceUrl"}})],1),a("el-row",[a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"作者",prop:"author"}},[a("el-input",{attrs:{placeholder:"作者"},model:{value:e.articles[e.selectedIndex].author,callback:function(t){e.$set(e.articles[e.selectedIndex],"author",t)},expression:"articles[selectedIndex].author"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"显示封面",prop:"showCoverPic"}},[a("el-switch",{model:{value:e.articles[e.selectedIndex].showCoverPic,callback:function(t){e.$set(e.articles[e.selectedIndex],"showCoverPic",t)},expression:"articles[selectedIndex].showCoverPic"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"允许评论",prop:"needOpenComment"}},[a("el-switch",{model:{value:e.articles[e.selectedIndex].needOpenComment,callback:function(t){e.$set(e.articles[e.selectedIndex],"needOpenComment",t)},expression:"articles[selectedIndex].needOpenComment"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"仅粉丝可评论",prop:"onlyFansCanComment"}},[a("el-switch",{model:{value:e.articles[e.selectedIndex].onlyFansCanComment,callback:function(t){e.$set(e.articles[e.selectedIndex],"onlyFansCanComment",t)},expression:"articles[selectedIndex].onlyFansCanComment"}})],1)],1)],1),a("el-form-item",{attrs:{label:"内容",prop:"content"}},[a("tinymce-editor",{ref:"editor",model:{value:e.articles[e.selectedIndex].content,callback:function(t){e.$set(e.articles[e.selectedIndex],"content",t)},expression:"articles[selectedIndex].content"}})],1)],1):e._e()],1),a("div",{staticClass:"dialog-footer"},[a("el-button",{on:{click:function(t){return e.$emit("hide")}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",disabled:e.uploading},on:{click:function(t){return e.dataFormSubmit()}}},[e._v(e._s(this.mediaId?"修改此篇":"全部提交（共"+e.articles.length+"篇）"))])],1),e.assetsSelectorVisible?a("assets-selector",{attrs:{visible:e.assetsSelectorVisible,selectType:"image"},on:{selected:e.onAssetsSelect}}):e._e()],1)},i=[],n=a("5530"),r=(a("d3b7"),a("3ca3"),a("ddb0"),{templateId:0,title:"",content:"",author:"",showCoverPic:!0,contentSourceUrl:"",digest:"",thumbMediaId:"",needOpenComment:!1,onlyFansCanComment:!1}),l={components:{TinymceEditor:function(){return a.e("chunk-ffc0e5ba").then(a.bind(null,"26dc"))},AssetsSelector:function(){return a.e("chunk-2d0b3e0b").then(a.bind(null,"29f4"))}},props:{visible:{type:Boolean,default:!1}},data:function(){return{assetsSelectorVisible:!1,mediaId:"",selectedIndex:0,articles:[],uploading:!1,dataRule:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],content:[{required:!0,message:"内容不能为空",trigger:"blur"}],thumbMediaId:[{required:!0,message:"封面图media_id不能为空",trigger:"blur"}],contentSourceUrl:[{required:!0,message:"原文地址不得为空",trigger:"blur"}]}}},methods:{init:function(e){e&&e.mediaId?(this.mediaId=e.mediaId,this.articles=e.content.articles):(this.mediaId="",this.articles=[Object(n["a"])({},r)])},dataFormSubmit:function(){var e=this;this.uploading||this.$refs["dataForm"].validate((function(t){t&&(e.mediaId?e.materialArticleUpdate():e.materialNewsUpload())}))},materialNewsUpload:function(){var e=this;this.uploading=!0,this.$http({url:this.$http.adornUrl("/manage/wxAssets/materialNewsUpload"),method:"post",data:this.$http.adornData(this.articles,!1)}).then((function(t){var a=t.data;a&&200===a.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.$emit("refreshDataList"),e.emit("hide")}}):e.$message.error(a.msg),e.uploading=!1}))},materialArticleUpdate:function(){var e=this;this.uploading=!0,this.$http({url:this.$http.adornUrl("/manage/wxAssets/materialArticleUpdate"),method:"post",data:this.$http.adornData({mediaId:this.mediaId,index:this.selectedIndex,articles:this.articles[this.selectedIndex]})}).then((function(t){var a=t.data;a&&200===a.code?e.$message.success("操作成功"):e.$message.error(a.msg),e.uploading=!1}))},addArticle:function(){this.articles.push(Object(n["a"])({},r)),this.selectedIndex=this.articles.length-1},onAssetsSelect:function(e){Vue.set(this.articles[this.selectedIndex],"thumbMediaId",e.mediaId),this.assetsSelectorVisible=!1}}},o=l,c=(a("d13f"),a("2877")),d=Object(c["a"])(o,s,i,!1,null,"2954f9d8",null);t["default"]=d.exports},d13f:function(e,t,a){"use strict";a("30dd")}}]);