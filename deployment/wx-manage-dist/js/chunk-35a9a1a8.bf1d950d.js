(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35a9a1a8"],{"30dd":function(e,t,s){},c1e1:function(e,t,s){"use strict";s.r(t);var l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}]},[s("div",{staticClass:"flex"},[s("div",{staticClass:"card-list"},[s("div",{staticClass:"text-center margin-bottom"},[e._v("图文列表")]),e._l(e.articles,(function(t,l){return s("div",{key:l,staticClass:"card-item",class:{selected:e.selectedIndex==l},on:{click:function(t){e.selectedIndex=l}}},[s("div",{staticClass:"text-cut-name"},[e._v(e._s(t.title))])])})),s("div",{directives:[{name:"show",rawName:"v-show",value:e.articles.length<8&&!e.mediaId,expression:"articles.length<8 && !mediaId"}],staticClass:"card-add el-icon-plus",on:{click:function(t){return e.addArticle()}}})],2),e.articles.length?s("el-form",{ref:"dataForm",attrs:{size:"mini",model:e.articles[e.selectedIndex],rules:e.dataRule,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"标题",prop:"title"}},[s("el-input",{attrs:{placeholder:"标题"},model:{value:e.articles[e.selectedIndex].title,callback:function(t){e.$set(e.articles[e.selectedIndex],"title",t)},expression:"articles[selectedIndex].title"}})],1),s("el-form-item",{attrs:{label:"封面图",prop:"thumbMediaId"}},[s("el-input",{attrs:{placeholder:"封面图media_id"},model:{value:e.articles[e.selectedIndex].thumbMediaId,callback:function(t){e.$set(e.articles[e.selectedIndex],"thumbMediaId",t)},expression:"articles[selectedIndex].thumbMediaId"}},[s("div",{attrs:{slot:"append"},on:{click:function(t){e.assetsSelectorVisible=!0}},slot:"append"},[e._v("从素材库中选择")])])],1),s("el-form-item",{attrs:{label:"摘要",prop:"digest"}},[s("el-input",{attrs:{placeholder:"摘要"},model:{value:e.articles[e.selectedIndex].digest,callback:function(t){e.$set(e.articles[e.selectedIndex],"digest",t)},expression:"articles[selectedIndex].digest"}})],1),s("el-form-item",{attrs:{label:"原文地址",prop:"contentSourceUrl"}},[s("el-input",{attrs:{placeholder:"阅读原文链接"},model:{value:e.articles[e.selectedIndex].contentSourceUrl,callback:function(t){e.$set(e.articles[e.selectedIndex],"contentSourceUrl",t)},expression:"articles[selectedIndex].contentSourceUrl"}})],1),s("el-row",[s("el-col",{attrs:{span:9}},[s("el-form-item",{attrs:{label:"作者",prop:"author"}},[s("el-input",{attrs:{placeholder:"作者"},model:{value:e.articles[e.selectedIndex].author,callback:function(t){e.$set(e.articles[e.selectedIndex],"author",t)},expression:"articles[selectedIndex].author"}})],1)],1),s("el-col",{attrs:{span:5}},[s("el-form-item",{attrs:{label:"显示封面",prop:"showCoverPic"}},[s("el-switch",{model:{value:e.articles[e.selectedIndex].showCoverPic,callback:function(t){e.$set(e.articles[e.selectedIndex],"showCoverPic",t)},expression:"articles[selectedIndex].showCoverPic"}})],1)],1),s("el-col",{attrs:{span:5}},[s("el-form-item",{attrs:{label:"允许评论",prop:"needOpenComment"}},[s("el-switch",{model:{value:e.articles[e.selectedIndex].needOpenComment,callback:function(t){e.$set(e.articles[e.selectedIndex],"needOpenComment",t)},expression:"articles[selectedIndex].needOpenComment"}})],1)],1),s("el-col",{attrs:{span:5}},[s("el-form-item",{attrs:{label:"仅粉丝可评论",prop:"onlyFansCanComment"}},[s("el-switch",{model:{value:e.articles[e.selectedIndex].onlyFansCanComment,callback:function(t){e.$set(e.articles[e.selectedIndex],"onlyFansCanComment",t)},expression:"articles[selectedIndex].onlyFansCanComment"}})],1)],1)],1),s("el-form-item",{attrs:{label:"内容",prop:"content"}},[s("tinymce-editor",{ref:"editor",model:{value:e.articles[e.selectedIndex].content,callback:function(t){e.$set(e.articles[e.selectedIndex],"content",t)},expression:"articles[selectedIndex].content"}})],1)],1):e._e()],1),s("div",{staticClass:"dialog-footer"},[s("el-button",{on:{click:function(t){return e.$emit("hide")}}},[e._v("取消")]),s("el-button",{attrs:{type:"primary",disabled:e.uploading},on:{click:function(t){return e.dataFormSubmit()}}},[e._v(e._s(this.mediaId?"修改此篇":"全部提交（共"+e.articles.length+"篇）"))])],1),e.assetsSelectorVisible?s("assets-selector",{attrs:{visible:e.assetsSelectorVisible,selectType:"image"},on:{selected:e.onAssetsSelect}}):e._e()],1)},a=[],i=s("5530"),n=(s("d3b7"),s("3ca3"),s("ddb0"),{templateId:0,title:"",content:"",author:"",showCoverPic:!0,contentSourceUrl:"",digest:"",thumbMediaId:"",needOpenComment:!1,onlyFansCanComment:!1}),c={components:{TinymceEditor:function(){return s.e("chunk-ffc0e5ba").then(s.bind(null,"26dc"))},AssetsSelector:function(){return s.e("chunk-2d0b3e0b").then(s.bind(null,"29f4"))}},props:{visible:{type:Boolean,default:!1}},data:function(){return{assetsSelectorVisible:!1,mediaId:"",selectedIndex:0,articles:[],uploading:!1,dataRule:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],content:[{required:!0,message:"内容不能为空",trigger:"blur"}],thumbMediaId:[{required:!0,message:"封面图media_id不能为空",trigger:"blur"}],contentSourceUrl:[{required:!0,message:"原文地址不得为空",trigger:"blur"}]}}},methods:{init:function(e){e&&e.mediaId?(this.mediaId=e.mediaId,this.articles=e.content.articles):(this.mediaId="",this.articles=[Object(i["a"])({},n)])},dataFormSubmit:function(){var e=this;this.uploading||this.$refs["dataForm"].validate((function(t){t&&(e.mediaId?e.materialArticleUpdate():e.materialNewsUpload())}))},materialNewsUpload:function(){var e=this;this.uploading=!0,this.$http({url:this.$http.adornUrl("/manage/wxAssets/materialNewsUpload"),method:"post",data:this.$http.adornData(this.articles,!1)}).then((function(t){var s=t.data;s&&200===s.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.$emit("refreshDataList"),e.emit("hide")}}):e.$message.error(s.msg),e.uploading=!1}))},materialArticleUpdate:function(){var e=this;this.uploading=!0,this.$http({url:this.$http.adornUrl("/manage/wxAssets/materialArticleUpdate"),method:"post",data:this.$http.adornData({mediaId:this.mediaId,index:this.selectedIndex,articles:this.articles[this.selectedIndex]})}).then((function(t){var s=t.data;s&&200===s.code?e.$message.success("操作成功"):e.$message.error(s.msg),e.uploading=!1}))},addArticle:function(){this.articles.push(Object(i["a"])({},n)),this.selectedIndex=this.articles.length-1},onAssetsSelect:function(e){Vue.set(this.articles[this.selectedIndex],"thumbMediaId",e.mediaId),this.assetsSelectorVisible=!1}}},r=c,d=(s("d13f"),s("2877")),o=Object(d["a"])(r,l,a,!1,null,"2954f9d8",null);t["default"]=o.exports},d13f:function(e,t,s){"use strict";s("30dd")}}]);